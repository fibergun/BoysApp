<!DOCTYPE html>
<html>
<head>
    <title>Sentence App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Sentence App</h1>
        <form id="sentenceForm" class="mb-3">
            <input type="text" id="sentenceInput" class="form-control mb-2" placeholder="Enter a sentence" required>
            <button type="button" class="btn btn-primary" onclick="addSentence()">Add Sentence</button>
        </form>
        <button class="btn btn-success" onclick="getRandomSentence()">Get Random Sentence</button>
        <button class="btn btn-warning" onclick="saveSentences()">Save Sentences to Excel</button>
        <p id="randomSentence" class="mt-3"></p>
    </div>

    <script>
        function addSentence() {
            const input = document.getElementById('sentenceInput').value;
            fetch('/add', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ sentence: input })
            }).then(() => {
                alert('Sentence added!');
                document.getElementById('sentenceInput').value = '';
            });
        }

        function getRandomSentence() {
            fetch('/random')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('randomSentence').innerText = data.sentence || 'No sentences available.';
                });
        }

        function saveSentences() {
            fetch('/save', {
                method: 'POST'
            }).then(response => {
                if (response.ok) {
                    alert('Sentences saved to Excel!');
                } else {
                    alert('Failed to save sentences.');
                }
            });
        }
    </script>
</body>
</html>